{
  "index_patterns": ["panw*","panos*"],
  "order" : 0,
  "settings": {
    "number_of_shards": 1,
    "number_of_replicas": 2,
    "index.mapping.ignore_malformed": true,
    "index.mapping.coerce": true,
    "index.default_pipeline": "geoip_useragent_pipeline"
  },
  "aliases": {
    "panw": {}
  },
  "mappings": {
    "_doc": {
      "properties": {

        "ecs" {
          "properties": {
            "version": {
              "type": "keyword"
            }
          }
        },
        "labels" : {
          "properties": {
            "panw": {
              "type": "keyword"
            },
            "panos": {
              "type": "keyword"
            }
          }
        },

        "@timestamp" : {
          "type": "date"
        },

        "observer": {
          "properties": {
            "hostname": {
              "type": "keyword"
            },
            "serial_number": {
              "type": "keyword"
            },
            "type": {
              "type": "keyword"
            },
            "vendor": {
              "type": "keyword"
            },
            "version": {
              "type": "keyword",
              "ignore_above": 8
            }
          }
        },

        "event": {
          "properties": {
            "action": {
              "type": "keyword",
              "ignore_above": 256
            },
            "direction": {
              "type": "keyword",
              "ignore_above": 256
            },
            "created": {
              "type": "date",
              "format": "yyyy/MM/dd HH:mm:ss||yyyy/MM/dd||epoch_millis"
            },
            "duration": {
              "type": "long"
            },
            "severity": {
              "type": "long",
              "properties": {
                "text": {
                  "type": "keyword"
                }
              }
            },
            "repeat_count": {
              "type": "long"
            },
            "hash": {
              "type": "keyword",
              "ignore_above": 256
            }
          }
        },

        "source": {
          "properties": {
            "bytes": {
              "type": "long"
            },
            "ip": {
              "type": "ip"
            },
            "packets": {
              "type": "long"
            },
            "port": {
              "type": "long"
            },
            "geo": {
              "properties": {
                "country_name": {
                  "type": "keyword",
                  "ignore_above":256,
                  "fields" {
                    "text": {
                      "type": "text"
                    }
                  }
                }
              }
            },
            "user": {
              "properties": {
                "name": {
                  "type": "keyword",
                  "ignore_above":256,
                  "fields" {
                    "text": {
                      "type": "text"
                    }
                  }
                }
              }
            },
            "nat": {
              "properties": {
                "ip": {
                  "type": "ip"
                },
                "port": {
                  "type": "long"
                }
              }
            },
            "zone": {
              "type": "keyword",
              "ignore_above": 256
            }
          }
        },

        "destination": {
          "properties": {
            "bytes": {
              "type": "long"
            },
            "ip": {
              "type": "ip"
            },
            "packets": {
              "type": "long"
            },
            "port": {
              "type": "long"
            },
            "geo": {
              "properties": {
                "country_name": {
                  "type": "keyword",
                  "ignore_above":256,
                  "fields" {
                    "text": {
                      "type": "text"
                    }
                  }
                }
              }
            },
            "user": {
              "properties": {
                "name": {
                  "type": "keyword",
                  "ignore_above":256,
                  "fields" {
                    "text": {
                      "type": "text"
                    }
                  }
                }
              }
            },
            "nat": {
              "properties": {
                "ip": {
                  "type": "ip"
                },
                "port": {
                  "type": "long"
                }
              }
            },
            "zone": {
              "type": "keyword",
              "ignore_above": 256
            }
          }
        },

        "network": {
          "properties": {
            "application": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "bytes": {
              "type": "long"
            },
            "packets": {
              "type": "long"
            },
            "protocol": {
              "type": "keyword"
            }
          }
        },

        "http": {
          "properties": {
            "response": {
              "properties": {
                "headers": {
                  "type": "keyword",
                  "ignore_above":1024,
                  "fields" {
                    "text": {
                      "type": "text"
                    }
                  }
                }
              },
              "request": {
                "properties": {
                  "method": {
                    "type": "keyword"
                  }
                }
              }
            }
          }
        },

        "url": {
          "properties": {
            "full": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "index": {
              "type": "long"
            }
          }
        },

        "user_agent": {
          "properties": {
            "original": {
              "type": "keyword"
            }
          }
        },

        "panw": {
          "properties": {
            "action_flags": {
              "type": "byte"
            },
            "action_source": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "destination_VM_UUID": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "flags": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "inbound_interface": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "log_action": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "log_subtype": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "monitor_tag/IMEI": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "outbound_interface": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "parent_session_ID": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "parent_start_time": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "rcv_time_control_plane": {
              "type": "date",
              "format": "yyyy/MM/dd HH:mm:ss||yyyy/MM/dd||epoch_millis"
            },
            "rule_name": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "sequence_number": {
              "type": "long"
            },
            "pcap_id": {
              "type": "long"
            },
            "session_end_reason": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "X_forwarded_for": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "content_type": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "content_version": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "payload_protocol_id": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "recipient": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "referrer": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "report_ID": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "sender": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "subject": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "threat_id": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "threat_category": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "threat_type": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },

            "file_digest": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "file_type": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "cloud": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "session_id": {
              "type": "long"
            },
            "session_start_time": {
              "type": "date",
              "format": "yyyy/MM/dd HH:mm:ss||yyyy/MM/dd||epoch_millis"
            },
            "source_VM_UUID": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "tunnel_ID/IMSI": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "tunnel_type": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "virtual_system": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            },
            "virtual_system_name": {
              "type": "keyword",
              "ignore_above":256,
              "fields" {
                "text": {
                  "type": "text"
                }
              }
            }
          }
        }

      }
    }
  }
}
'
