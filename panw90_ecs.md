////
This file is generated! See scripts/docs_collector.py
////

[[filebeat-module-panw]]
[role="xpack"]

:modulename: panw
:has-dashboards: true

== Palo Alto Networks module

This is a module for Palo Alto Networks PAN-OS firewall monitoring logs received
over Syslog or read from a file. It currently supports messages of Traffic and
Threat types.

[float]
=== Compatibility

This module has been tested with logs generated by devices running PAN-OS
versions 9.0. For reference older version panos 8.1, panos 8.0 and panos 7.1. here <add pointers>

The {plugins}/ingest-geoip.html[ingest-geoip]
Elasticsearch plugin is required to run this module.

include::../include/running-modules.asciidoc[]

[float]
=== ECS field mappings

These are the PAN-OS to ECS field mappings as well as those fields still not
in ECS that are added under the `panw` prefix:

PAN-OS 9.0 reference documentation
 https://docs.paloaltonetworks.com/pan-os/9-0/pan-os-admin/monitoring/use-syslog-for-monitoring/syslog-field-descriptions/traffic-log-fields.html


.Traffic log mappings
[options="header"]
|==============
| PAN-OS Documented Field | ECS Field | Non-standard field | Note
| FUTURE_USE |  |  | removed
| Receive Time | | panw.rcv_time_control_plane |
| Serial Number | observer.serial_number | |
| Type | | | removed
| Threat/Content Type | | panw.log_subtype |
| FUTURE_USE | | | removed
| Generated Time | `@timestamp` | |
| Source Address | source.ip | |
| Destination Address | destination.ip | |
| NAT Source IP | source.nat.ip | | proposed extention to ecs
| NAT Destination IP | destination.nat.ip | | proposed extention to ecs
| Rule Name | | panw.rule_name |
| Source User | source.user.name | |
| Destination User | destination.user.name | |
| Application | network.application | |
| Virtual System | | panw.virtual_system |
| Source Zone | source.zone | | proposed extention to ecs
| Destination Zone | destination.zone | | proposed extention to ecs
| Inbound Interface | source.interface | | proposed extention to ecs
| Outbound Interface | destination.interface | | proposed extention to ecs
| Log Action | | panw.log_action |
| FUTURE_USE | | | removed
| Session ID | | panw.session_id |
| Repeat Count | event.repeat_count | | proposed extention to ecs
| Source Port | source.port | |
| Destination Port | destination.port | |
| NAT Source Port | source.nat.port | | proposed extention to ecs
| NAT Destination Port | destination.nat.port | | proposed extention to ecs
| Flags | | panw.flags |
| Protocol | network.protocol | |
| Action | event.action | |
| Bytes | network.bytes | |
| Bytes Sent | destination.bytes | |
| Bytes Received | source.bytes | |
| Packets | network.packets | |
| Start Time | event.created | |
| Elapsed Time | event.duration | |
| Category | url.category | |
| FUTURE_USE | | | removed
| Sequence Number | event.sequence | |
| Action Flags | | panw.action_flags |
| Source Location | source.geo.country_name | |
| Destination Location | destination.geo.country_name | |
| FUTURE_USE | | | removed
| Packets Sent | destination.packets
| Packets Received | source.packets
| Session End Reason | | panw.session_end_reason |
| Device Group Hierarchy Level 1 | | panw.device_group_hierarchy_level_1 |
| Device Group Hierarchy Level 2 | | panw.device_group_hierarchy_level_2 |
| Device Group Hierarchy Level 3 | | panw.device_group_hierarchy_level_3 |
| Device Group Hierarchy Level 4 | | panw.device_group_hierarchy_level_4 |
| Virtual System Name | | panw.virtual_system_name |
| Device Name | observer.hostname | |
| Action Source | | panw.action_source | |
| Source VM UUID | | panw.source_VM_UUID |
| Destination VM UUID | | panw.destination_VM_UUID |
| Tunnel ID/IMSI | | panw.tunnel_ID/IMSI |
| Monitor Tag/IMEI | | panw.monitor_tag/IMEI |
| Parent Session ID | | panw.parent_session_ID |
| Parent Start Time | | panw.parent_start_time |
| Tunnel Type | | panw.tunnel_type |
| SCTP Association ID | | panw.SCTP_association_ID |
| SCTP Chunks | | panw.SCTP_chunks |
| SCTP Chunks Sent | | panw.SCTP_chunks_sent |
| SCTP Chunks Received | | panw.SCTP_chunks_received |
| UUID for rule | | panw.UUID_for_rule |
|==============

.Threat logs mappings
[options="header"]
|==============
| PAN-OS Field | ECS Field | Non-standard field | Note
| FUTURE_USE |  |  | removed
| Receive Time | | panw.rcv_time_control_plane |
| Serial Number | observer.serial_number | |
| Type | | | removed
| Threat/Content Type | | panw.log_subtype |
| FUTURE_USE | | | removed
| Generated Time | `@timestamp` | |
| Source Address | source.ip | |
| Destination Address | destination.ip | |
| NAT Source IP | source.nat.ip | | proposed extention to ecs
| NAT Destination IP | destination.nat.ip | | proposed extention to ecs
| Rule Name | | panw.rule_name |
| Source User | source.user.name | |
| Destination User | destination.user.name | |
| Application | network.application | |
| Virtual System | | panw.virtual_system |
| Source Zone | source.zone | | proposed extention to ecs
| Destination Zone | destination.zone | | proposed extention to ecs
| Inbound Interface | source.interface | | proposed extention to ecs
| Outbound Interface | destination.interface | | proposed extention to ecs
| Log Action | | panw.log_action |
| FUTURE_USE | | | removed
| Session ID | | panw.session_id |
| Repeat Count | event.repeat_count | | proposed extention to ecs
| Source Port | source.port | |
| Destination Port | destination.port | |
| NAT Source Port | source.nat.port | | proposed extention to ecs
| NAT Destination Port | destination.nat.port | | proposed extention to ecs
| Flags | | panw.flags |
| Protocol | network.protocol | |
| Action | event.action | |
| URL/Filename | url.full | |
| Threat ID | | panw.threat_ID |
| Category | url.category | | proposed extention to ecs
| Severity | event.severity | |
| Direction | event.direction | |
| Sequence Number | | panw.sequence_number |
| Action Flags | | panw.action_flags |
| Source Location | source.geo.country_name | |
| Destination Location | destination.geo.country_name | |
| FUTURE_USE | | | removed
| Content Type | | http.content_type |
| PCAP_ID | | panw.PCAP_ID |
| File Digest | | panw.file_digest |
| Cloud | cloud.provider | |
| URL Index | url.index | |
| User Agent | | panw.user_agent | 
| File Type | file.file_type | |
| X-Forwarded-For | | http.X_forwarded_for |
| Referer | http.request.referrer | |
| Sender | | panw.sender |
| Subject | | panw.subject |
| Recipient | | panw.recipient |
| Report ID | | panw.report_ID |
| Device Group Hierarchy Level 1 | | panw.device_group_hierarchy_level_1 |
| Device Group Hierarchy Level 2 | | panw.device_group_hierarchy_level_2 |
| Device Group Hierarchy Level 3 | | panw.device_group_hierarchy_level_3 |
| Device Group Hierarchy Level 4 | | panw.device_group_hierarchy_level_4 |
| Virtual System Name | | panw.virtual_system_name |
| Device Name | observer.hostname | |
| FUTURE_USE | | | removed
| Source VM UUID | | panw.source_VM_UUID |
| Destination VM UUID | | panw.destination_VM_UUID |
| HTTP Method | http.request.method | |
| Tunnel ID/IMSI | | panw.tunnel_ID/IMSI |
| Monitor Tag/IMEI | | panw.monitor_tag/IMEI |
| Parent Session ID | | panw.parent_session_ID |
| Parent Start Time | | panw.parent_start_time |
| Tunnel Type | | panw.tunnel_type |
| Threat Category | | panw.threat_category |
| Content Version | | panw.content_version |
| FUTURE_USE | | | removed
| SCTP Association ID | | panw.SCTP_association_ID |
| Payload Protocol ID | | panw.payload_protocol_ID |
| HTTP Headers | http.response.headers | |
| UUID for rule | | panw.UUID_for_rule |
|==============

.HIP Match logs mappings
[options="header"]
|==============
| PAN-OS Field | ECS Field | Non-standard field | Note
| FUTURE_USE |  |  | removed
| Receive Time | | panw.rcv_time_control_plane |
| Serial Number | observer.serial_number | |
| Type | | | removed
| Threat/Content Type | | panw.log_subtype |
| FUTURE_USE | | | removed
| Generated Time | `@timestamp` | |
| Source User | source.user.name | |
| Virtual System | | panw.virtual_system | |
| Machine name | host.name | |
| OS | os.name | |
| Source Address | source.ip | |
| HIP | | panw.HIP_reportname |
| Repeat Count | event.repeat_count | | proposed extention to ecs
| HIP Type | | panw.HIP_Type |
| FUTURE_USE | | | removed
| FUTURE_USE | | | removed
| Sequence Number | event.sequence | | proposed extention to ecs
| Action Flags | | panw.action_flags |
| Device Group Hierarchy Level 1 | | panw.device_group_hierarchy_level_1 |
| Device Group Hierarchy Level 2 | | panw.device_group_hierarchy_level_2 |
| Device Group Hierarchy Level 3 | | panw.device_group_hierarchy_level_3 |
| Device Group Hierarchy Level 4 | | panw.device_group_hierarchy_level_4 |
| Virtual System Name | | panw.virtual_system_name |
| Device Name | observer.hostname | |
| Virtual System ID | | panw.virtual_system_ID |
| IPv6 Source Address | source.ip | | v6 source.ip
| Host ID | host.id | |
|==============

.UserID logs mappings
[options="header"]
|==============
| PAN-OS Field | ECS Field | Non-standard field | Note
| FUTURE_USE |  |  | removed
| Receive Time | | panw.rcv_time_control_plane |
| Serial Number | observer.serial_number | |
| Type | | | removed
| Threat/Content Type | | panw.log_subtype |
| FUTURE_USE | | | removed
| Generated Time | `@timestamp` | |
| Virtual System | | panw.virtual_system | |
| Source IP | source.ip | |
| User | user.name | |
| Data Source Name | | panw.data_src_name |
| Event ID | | panw.event_id |
| Repeat Count | event.repeat_count | | proposed extention to ecs
| Time Out Threshold | | panw.time_out_threshold |
| Source Port | source.port | |
| Destination Port | destination.port | |
| Data Source | | panw.data_src |
| Data Source Type | | panw.data_src_type }
| Sequence Number | event.sequence | |
| Action Flags | | panw.action_flags |
| Device Group Hierarchy Level 1 | | panw.device_group_hierarchy_level_1 |
| Device Group Hierarchy Level 2 | | panw.device_group_hierarchy_level_2 |
| Device Group Hierarchy Level 3 | | panw.device_group_hierarchy_level_3 |
| Device Group Hierarchy Level 4 | | panw.device_group_hierarchy_level_4 |
| Virtual System Name | | panw.virtual_system_name |
| Device Name | observer.hostname | |
| Virtual System ID | | panw.virtual_system_ID |
| Factor Type |
| Factor Completion Time |
| Factor Number |
| FUTURE_USE | | | removed
| FUTURE_USE | | | removed
| User Group | | panw.user_group |
| Flags | | panw.flags |
| Source by User | | panw.src_by_user |
|==============
	

// [float]
// === Example dashboard
//
// This module comes with a sample dashboard:
//
// (TODO)
// [role="screenshot"]
// image::./images/kibana-cisco-asa.png[]

include::../include/configuring-intro.asciidoc[]

The module is by default configured to run via syslog on port 9001. However
it can also be configured to read logs from a file. See the following example.

["source","yaml",subs="attributes"]
-----
- module: panw
  pan_os:
    enabled: true
    var.paths: ["/var/log/pan-os.log"]
    var.input: "file"
-----

:fileset_ex: pan_os

include::../include/config-option-intro.asciidoc[]

[float]
==== `pan_os` fileset settings

Example config:

[source,yaml]
----
  pan_os:
    var.syslog_host: 0.0.0.0
    var.syslog_port: 514
----

include::../include/var-paths.asciidoc[]

*`var.syslog_host`*::

The interface to listen to UDP based syslog traffic. Defaults to `localhost`.
Set to `0.0.0.0` to bind to all available interfaces.

*`var.syslog_port`*::

The UDP port to listen for syslog traffic. Defaults to `9001`

NOTE: Ports below 1024 require {beatname_uc} to run as root.

:has-dashboards!:

:fileset_ex!:

:modulename!:


[float]
=== Fields

For a description of each field in the module, see the
<<exported-fields-panw,exported fields>> section.

